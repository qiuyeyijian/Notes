## 第四章作业

### 4-02

网络互连可以扩大用户共享资源范围和更大的通信域

需要解决的共同问题

* 不同的管理和控制方式
* 面向连接还是面向无连接
* 用户的接入控制
* 路由的选择技术
* 超时重传，差错恢复，最大分组，状态报告



### 4-03

转发器：只有两个接口，只实现信号的转发 ，不提供信号过滤功能。主要用于延伸网络直径。和中继器配合使用可以增大布线距离。工作在物理层

集线器：可以用于连接多个主机，本身不能识别MAC地址和IP地址，数据采用广播方式传输，增大了广播域和冲突域。工作在物理层。

网桥：用于将两个相似网段连接在一起，隔离冲突域但扩大了广播域。不仅具有中继器的信号放大，增加布线距离的功能。同时也提供简单的流量控制。一般只有两个端口。工作在数据链路层。

交换机：交换机可以看做是一种多端口的网桥。同时具有集线器和网桥的功能。可以进行流量控制，比如过滤一些MAC帧。可以利用交换机划分虚拟局域网。一般所说的交换机是两层交换机，更高级的三层交换机具有路由功能。工作在数据链路层。

路由器：用于连接不同的局域网，提供路由功能。可以隔离广播域和冲突域。能进行数据包的转发、过滤、路由等。工作在网络层。

网关：包括路由器在内的一系列高级的网络设备都可以称为网关，是一个大的概念。网关可以说实现两个不同网络的互联，对不兼容的高层网络协议的转换等。网关是一个局域网的出口和入口，比如路由器，三层交换机，防火墙等都可以作为网关。



### 4-04

IP协议：实现网络互互联；是TCP/IP体系内最重要的协议之一。

ARP协议：将IP地址解析成对应的MAC地址。

RARP协议：反向ARP协议，将MAC地址解析成对应的IP地址。

ICMP协议：网控制消息协议，主要用来提供差错报告和询问报文。



### 4-05

IP地址分为A, B, C, D, E五类。

A类，B类和C类地址的网络号字段分别为1个，2个和3个字节长，而在网络号字段的最前面有1-3位的类别位，其数值分别规定为0， 10和110.

A类，B类和C类地址的主机号字段分别为3个、2个和1个字节长。

D类地址用于多播（前4位是1110）

E类地址（前4位是1111）保留为以后使用。

IP地址的主要特点是全球唯一，每类地址均由网络号和主机号组成。

### 4-06

| 网络类别 | 可指派的网络数 | 每个网络中可指派的主机数 |
| -------- | -------------- | ------------------------ |
| A        | 126            | 16777214                 |
| B        | 16384          | 65534                    |
| C        | 2097152        | 254                      |



### 4-07

我们平常所说的互连网是由很多小的局域网组成的，我们可以使用IP地址来唯一标识这些局域网。但是在这些局域网环境错综复杂，由他们内部使用MAC地址进行寻址。这样体现分层原理。

- **历史原因：** 以太网诞生于因特网之前，在IP地址之前MAC地址就已经在使用了。两者结合使用，是为了不影响已存在的协议
- **分层实现：** 对网路协议进行分层以后，数据链路层的实现不需要考虑数据之间的转发，网络层的实现不需要考数据链路层的影响。
- **分工合作：** IP地址是会随着主机接入网络的不同而发生改变的，而MAC一般不会改变。这样的话，我们可以使用IP地址进行寻址，当数据报和目的主机处于同一网络时，就使用MAC地址进行数据交付。



### 4-09

1. 对于A类IP地址，前8位表示网络号，中间16位用于子网划分，最后8位表示主机号。对于B类IP地址，前16位表示网络号，中间8位用于网络划分，最后8位表示主机号。对于C类地址，前24位为主机号，后8位表示主机号，这个子网掩码是C类网络的默认子网掩码。
2. 最后三位表示主机号，扣除全0和全1，能够连接6台主机。
3. 子网掩码都为 255.255.255.0,，但是能表示的子网数目不同。
4. 主机位为12位，扣除全0和全1，每个子网能表示的最大主机数是4094
5. 不是
6. 194.47.20.129，C类地址
7. 有，因为如果C类地址可以选择后8位进行进一步的子网划分



### 4-10

B	A	B	C	A	C

### 4-11

* 减少计算量，加快分组转发。
* 数据部分如果出现差错不能及时发现。



### 4-12

* 差错控制应交由上层来实现，这样可以减少路由器的工作量，加快分组转发。
* IP数据报出错部分可能是源地址，请求错误的源地址重传数据只会浪费资源。
* 不采用CRC校验也是为了减少计算量，怎加路由器的吞吐量。



### 4-13

![11](assets/%E7%AC%AC%E5%9B%9B%E7%AB%A0%E4%BD%9C%E4%B8%9A/11.jpg)



### 4-15

IP层下面的数据链路层所限定的帧格式中数据字段的最大长度。

与IP数据报首部中总长度字段有关系。

### 4-16

在目的站而不是中间路由器进行组装是由于：

* 如果通过一个网路就进行组装，就必须组装和分片多次，浪费网路资源，增加延时。
* 数据包的分片可能会有各自的路径，所以中间路由器可能不能获取到所有的数据报分片。
* 减轻路由器负担，提高路由器吞吐量。



### 4-17

![17](assets/%E7%AC%AC%E5%9B%9B%E7%AB%A0%E4%BD%9C%E4%B8%9A/17.jpg)



### 4-19

6次，主机A使用一次，途径的每个路由器使用一次

### 4-20

1. m0
2. R2
3. R4
4. R3
5. R4

### 4-21

| 地点 | 子网号   | 子网网络号   | 主机IP的最小值和最大值        |
| ---- | -------- | ------------ | ----------------------------- |
| 1    | 00000001 | 129.250.1.0  | 129.250.1.1 - 129.250.1.254   |
| 2    | 00000010 | 129.250.2.0  | 129.250.2.1 - 129.250.2.254   |
| 3    | 00000011 | 129.250.3.0  | 129.250.3.1 - 129.250.3.254   |
| 4    | 00000100 | 129.250.4.0  | 129.250.4.1 - 129.250.4.254   |
| 5    | 00000101 | 129.250.5.0  | 129.250.5.1 - 129.250.5.254   |
| 6    | 00000110 | 129.250.6.0  | 129.250.6.1 - 129.250.6.254   |
| 7    | 00000111 | 129.250.7.0  | 129.250.7.1 - 129.250.7.254   |
| 8    | 00001000 | 129.250.8.0  | 129.250.8.1 - 129.250.8.254   |
| 9    | 00001001 | 129.250.9.0  | 129.250.9.1 - 129.250.9.254   |
| 10   | 00001010 | 129.250.10.0 | 129.250.10.1 - 129.250.10.254 |
| 11   | 00001011 | 129.250.11.0 | 129.250.11.1 - 129.250.11.254 |
| 12   | 00001100 | 129.250.12.0 | 129.250.12.1 - 129.250.12.254 |
| 13   | 00001101 | 129.250.13.0 | 129.250.13.1 - 129.250.13.254 |
| 14   | 00001110 | 129.250.14.0 | 129.250.14.1 - 129.250.14.254 |
| 15   | 00001111 | 129.250.15.0 | 129.250.15.1 - 129.250.15.254 |
| 16   | 00010000 | 129.250.16.0 | 129.250.16.1 - 129.250.16.254 |



### 4-22

![22](assets/%E7%AC%AC%E5%9B%9B%E7%AB%A0/22.jpg)



### 4-27

![27](assets/%E7%AC%AC%E5%9B%9B%E7%AB%A0/27.jpg)



### 4-28

![image-20201121131030006](assets/%E7%AC%AC%E5%9B%9B%E7%AB%A0%E4%BD%9C%E4%B8%9A/image-20201121131030006.png)

### 4-29

| 网段 | 地址              |
| ---- | ----------------- |
| LAN1 | 30.138.118.192/27 |
| LAN2 | 30.138.118.0/25   |
| LAN3 | 30.138.118.0/24   |
| LAN4 | 30.138.118.224/27 |
| LAN5 | 30.138.118.128/27 |



### 4-32

![32](assets/%E7%AC%AC%E5%9B%9B%E7%AB%A0/32.jpg)



### 4-35

![35](assets/%E7%AC%AC%E5%9B%9B%E7%AB%A0/35.jpg)



### 4-37

![37](assets/%E7%AC%AC%E5%9B%9B%E7%AB%A0/37.jpg)



### 4-38

IGP：内部网关协议，是在自治系统内使用的路由协议，力求最佳路由。

EGP：外部网关协议，是在自治系统间使用的路由协议，力求较好的路由。

4-39

RIP是一种分布式的基于距离向量的路由选择协议，主要特点如下: 

- 仅和相邻路由器交换信息 
- 路由器交换的信息是当前本路由器所知道的全部信息 
- 按固定的时间间隔交换路由信息，例如，间隔30s 

OSPE最主要的特征是使用分布式的链路状态协议，特点如下: 

- 使用洪泛法想本自治系统的所有路由器发信息 
- 发送的信息是与本路由器相连的所有路由器的链路状态 
- 只有当链路状态发送变化时，才会发送信息 

BGP是不同自治系统的路由器之间交换路由信息的协议，采用路径向量路由选择协议，特点: 

- BGP协议再系统间交换“可达性协议” 
- 自治系统AS间的路由选择必须考虑有关策略 
- 选择能达到路径的较好路由，而非最佳路由

### 4-40

RIP运行在小型的网络中，且只和临站交换路由信息，使用UDP开销小，足以满足要求。

OSPF使用泛洪法，直接使用IP比较灵活，开销小。

BGP需要交换整个路由表和更新信息，需要使用TCP进行可靠交付。



RIP使用UDP，不保证可靠性，所以必须周期性更新信息。BGP使用TCP，保证了可靠性，所以不需要想RIP一样。



### 4-41

| 目的网络 | 距离 | 下一条 | 说明                                                       |
| -------- | ---- | ------ | ---------------------------------------------------------- |
| N1       | 7    | A      | 无更新信息，不变                                           |
| N2       | 5    | C      | 相同的下一跳（因为从C发来的信息，可以认为下一条是C），更新 |
| N3       | 9    | C      | 新的路由信息，距离加1，直接插入                            |
| N6       | 5    | C      | 不同的下一条，距离更短，更新                               |
| N8       | 4    | E      | 不同的下一条，距离不变，不变                               |
| N9       | 4    | F      | 不同的下一条，距离更大，不变                               |



### 4-42

| 目的网络 | 距离 | 下一条 | 说明                         |
| -------- | ---- | ------ | ---------------------------- |
| N1       | 3    | C      | 不同的下一跳，距离更短，更新 |
| N2       | 2    | C      | 相同的下一跳，距离相同，不变 |
| N3       | 1    | F      | 不同的下一跳，距离更大，不变 |
| N4       | 5    | G      | 不同的下一跳，距离更大，不变 |



### 4-44

VPN属于远程访问技术,简单地说就是利用公用网络架设专用网络,进行加密通讯。专业解释就是VPN网关通过对数据包的加密和数据包目标地址的转换实现远程访问。

**优点**

1.VPN能够让移动员工、远程员工、商务合作伙伴和其他人利用本地可用的高速宽带网连接(如DSL、有线电视或者WiFi网络)连接到企业网络。此外,高速宽带网连接提供一种成本效率高的连接远程办公室的方法。

2.设计良好的宽带VPN是模块化的和可升级的。VPN能够让应用者使用一种很容易设置的互联网基础设施,让新的用户迅速和轻松地添加到这个网络。

3.VPN能提供高水平的安全,使用高级的加密和身份识别协议保护数据避免受到窥探,阻止数据窃贼和其他非授权用户接触这种数据。

4.完全控制,虚拟专用网使用户可以利用ISP的设施和服务,同时又完全掌握着自己网络的控制权。

**缺点**

1.企业不能直接控制基于互联网的VPN的可靠性和性能。机构必须依靠提供VPN的互联网服务提供商保证服务的运行。这个因素使企业与互联网服务提供商签署一个服务级协议非常重要,要签署一个保证各种性能指标的协议。

2.企业创建和部署VPN线路并不容易。这种技术需要高水平地理解网络和安全问题,需要认真的规划和配置。因此,选择互联网服务提供商负责运行VPN的大多数事情是一个好主意。

3.不同厂商的VPN产品和解决方案总是不兼容的,因为许多厂商不愿意或者不能遵守VPN技术标准。因此,混合使用不同厂商的产品可能会出现技术问题。另一方面,使用一家供应商的设备可能会提高成本。

4.当使用无线设备时,VPN有安全风险。在接入点之间漫游特别容易出问题。当用户在接入点之间漫游的时候,任何使用高级加密技术的解决方案都可能被攻破。

**分类**

1、按VPN的协议分类:、PPTP、L2TP和IPSec

2、按VPN的应用分类:Access VPN(远程接入VPN)、Intranet VPN(内联网VPN、Extranet VPN(外联网VPN）

3、按所用的设备类型进行分类:路由器式VPN、交换机式VPN、防火墙式VPN

4.按照实现原理划分:重叠VPN、对等VPN

### 4-45

**什么是NAT**

NAT通常部署在一个组织的网络出口位置，通过将内部网络IP地址替换为出口的IP地址提供公网可达性和上层协议的连接能力。

**NAT特点**

网络被分为私网和公网两个部分，NAT网关设置在私网到公网的路由出口位置，双向流量必须都要经过NAT网关。网络访问只能先由私网侧发起，公网无法主动访问私网主机；

**NAT的优点：**

节省公有合法IP地址，增强灵活性、安全性

**NAT的缺点：**

延迟增大，配置和维护的复杂性，不支持某些应用

### 4-47

![47](assets/%E7%AC%AC%E5%9B%9B%E7%AB%A0%E4%BD%9C%E4%B8%9A/47.jpg)



### 4-50，4--52

![5052](assets/%E7%AC%AC%E5%9B%9B%E7%AB%A0%E4%BD%9C%E4%B8%9A/5052.jpg)



### 4-55

| 目的网络地址 | 子网掩码      | 下一跳           |
| ------------ | ------------- | ---------------- |
| 145.13.0.0   | 255.255.192.0 | 直接交付，接口m0 |
| 145.13.64.0  | 255.255.192.0 | 直接交付，接口m1 |
| 145.13.128.0 | 255.255.192.0 | 直接交付，接口m2 |
| 145.13.192.0 | 255.255.192.0 | 直接交付，接口m3 |
| 其他         | M             | 默认路由，接口m4 |

接口m2所在网段地址范围为，145.13.128.1 - 145.13.191.254，所以从接口m2转发。



