## 一、实验预习报告

### 1、实验相关知识简述

NAT (Network Address Translation，网络地址转换)是194年提出的，主要用来解决专用地址和全球地址的转换问题。局域网内部的通信只需要专用地址可以了，当访问因特网时可以转换成一个全球地址去访问。这种方法需要在专用网连接到因特网的路由器上安装NAT软件，装有NAT软件的路由器叫做NAT路由器，他至少有一个有效的外部全球IP地址。



### 2、实验原理预习情况

学习了NAT的基本概念，了解了NAT配置的基本命令，熟悉了NAT的应用场景。

### 3、实验注意事项

注意Cisco用户模式、特权模式、全局配置模式分别对应的命令。

注意禁止IP地址解析特性，避免因为输入错误命令，浪费不必要的时间



## 二、实验报告

### 1、实验目的与要求

* 理地址转换NAT的含义
* 理解地址转换NAT的3种方式
* 初步掌握地址转换NAT的配置和应用



### 2、实验仪器或材料

- 一台装有Windows 10系统的PC机
- Packet Tracker软件



### 3、实验原理

NAT包括3种技术类型:

* 静态NAT是把内部网络中的每个主机地址永久映射成外部网络中的某个合法地址。如果内部网络有对外提供服务的需求，如WWW服务器、FTP服务器等，那么这些服务器的IP地址应该采用静态地址转换，以便外部用户可以使用这些服务。静态地址转换不能节省IP地址。

* 动态NAT是采用把外部网络中的系列公网地址 使用动态分配的方法映射到内部网络的。转换时，从内部合法地址范围中动态地选择一个未使用的地址 与内部专用地址进行转换。当然，当内部合法地址使用完毕时，后续的NAT申请将失败，

* 端口映射是把内部地址映射到一个内部合法P地址的不同端口上，这也是一种动态的地址转换，适用于只申请到:少量IP地址的情况。



### 4、实验过程及数据记录

#### （1）网络拓扑

![image-20201214225202278](assets/%E5%AE%9E%E9%AA%8C%E5%8D%81%E4%B8%80%EF%BC%9A%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2/image-20201214225202278.png)





**网络拓扑说明**

| 序号 | 设备    | 设备类型   | 规格型号 |
| ---- | ------- | ---------- | -------- |
| 1    | PC0-PC1 | 用户主机   | PC       |
| 2    | SW0-SW2 | 两层交换机 | 2960     |
| 3    | R0-R1   | 路由器     | 2811     |

#### （2）网络规划

| 名称          | 接口 | IP地址       | 网关        |
| ------------- | ---- | ------------ | ----------- |
| R0            | f0/0 | 192.168.1.1  |             |
|               | s1/0 | 98.5.5.1     |             |
| R1            | s1/0 | 98.5.5.2     |             |
|               | f0/0 | 211.1.1.1    |             |
| PC0           |      | 192.168.1.11 | 192.168.1.1 |
| PC1           |      | 211.1.1.11   | 211.1.1.1   |
| 内部WWW服务器 |      | 192.168.1.12 | 192.168.1.1 |
| 外部WWW服务器 |      | 211.1.1.12   | 211.1.1.1   |



#### （3）实验步骤

1. 搭建完整的网络拓扑图
2. 分别给主机和路由器接口配置IP地址，注意路由器配置的时候禁用域名解析，防止万一输错命令浪费时间。

3. 使用RIP协议将R0的98.5.5.0网段发布出去，将R1的98.5.5.0网段和211.1.1.0网段发布出去。注意不要将R0的内部网段发布出去。

![image-20201214222319423](assets/%E5%AE%9E%E9%AA%8C%E5%8D%81%E4%B8%80%EF%BC%9A%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2/image-20201214222319423.png)

![image-20201214222327305](assets/%E5%AE%9E%E9%AA%8C%E5%8D%81%E4%B8%80%EF%BC%9A%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2/image-20201214222327305.png)

4. 接下来在R0上配置NAT，下面是详细步骤

![image-20201214224808564](assets/%E5%AE%9E%E9%AA%8C%E5%8D%81%E4%B8%80%EF%BC%9A%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2/image-20201214224808564.png)



5. 通过PC0去ping主机PC1，但PC1不可以ping通主机PC0，可以Ping通。查看R0的NAT转换表

![image-20201214225114564](assets/%E5%AE%9E%E9%AA%8C%E5%8D%81%E4%B8%80%EF%BC%9A%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2/image-20201214225114564.png)



6. 外部主机PC1可以访问内部WWW服务器

![image-20201214225249756](assets/%E5%AE%9E%E9%AA%8C%E5%8D%81%E4%B8%80%EF%BC%9A%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2/image-20201214225249756.png)



### 5、实验结果分析

通过R0的NAT转换表可以看到，外部地址通过访问公有合法地址98.5.5.1:80，经过NAT地址转换可以访问内部WWW服务器。

内部地址通过NAT转换可以访问到外部WWW服务器，也就是可以和互联网通信。但是外部主机去不能访问内部主机，达到了实验预期效果。



## 三、实验总结

通过本次实验，我了解了NAT的基本知识，熟悉了NAT的基本配置过程。

实验过程中，最后一步，外部主机访问内部WWW服务器时，一定要访问对外的公网地址。有几次都是直接访问了内部地址，还疑惑为什么会错，浪费了许多时间。

